vector(length=n.sen, mode="list")
for (k in 1:n.sen) {
sen <- sentences[[k]]
sen <- tolower(sen)
sen <- gsub("[[:punct:]]", "", sen)
words <- unlist(strsplit(sen, " "))
n.words <- length(words)
word.count[[i]][[j]][[k]] <- n.words
# Further nested lists
char.count[[i]][[j]][[k]] <-
vector(length=n.words, mode="list")
for (l in 1:n.words){
char.count[[i]][[j]][[k]][[l]] <- nchar(words)
}
}
}
}
unlist(par.count[undisputed])
boxplot(unlist(par.count[undisputed]) ~ authors)
boxplot(unlist(par.count[undisputed]) ~ authors, horizontal=TRUE)
boxplot(unlist(par.count[undisputed]) ~ authors, horizontal=TRUE,
xlab="# of Paragraphs")
value <- unlist(par.count[undisputed])
boxplot(value ~ authors, horizontal=TRUE,
xlab="# of Paragraphs")
lapply(sen.count, unlist)
lapply(sen.count[undisputed], unlist)
lapply(lapply(sen.count[undisputed], unlist), sum)
value <- unlist(value)
value <- lapply(sen.count[undisputed], unlist), sum)
value <- unlist(value)
value <- lapply(sen.count[undisputed], unlist), sum))
value <- lapply(sen.count[undisputed], unlist)
value
value <- lapply(lapply(sen.count[undisputed], unlist), sum)
value <- unlist(value)
value
boxplot(value ~ authors, horizontal=TRUE, xlab="# of Sentences")
boxplot(value ~ authors, horizontal=TRUE, xlab="# of sentences per essay")
value <- lapply(word.count[undisputed], unlist)
value
word.count
value <- lapply(word.count, function(x){lapply(x, unlist)})
value <- lapply(word.count, function(x){lapply(x, unlist)})
value
value <- lapply(value, function(x){lapply(x, unlist)})
value
value <- lapply(word.count, function(x){lapply(x, unlist)})
value
word.count
value <- lapply(word.count, function(x){lapply(x, unlist)})
value
lapply(value, function(x){lapply(x, sum)})
lapply(value, sum)
value <- lapply(value, function(x){lapply(x, sum)})
value <- lapply(value, unlist)
value
value
value <- lapply(value, sum)
value
boxplot(value ~ authors, horizontal=TRUE, xlab="# of words per essay")
value <- unlist(value)
value
boxplot(value ~ authors, horizontal=TRUE, xlab="# of words per essay")
value
value <- lapply(word.count[undisputed], function(x){lapply(x, unlist)})
value <- lapply(value, function(x){lapply(x, sum)})
value <- lapply(value, unlist)
value <- lapply(value, sum)
value <- unlist(value)
boxplot(value ~ authors, horizontal=TRUE, xlab="# of words per essay")
value <- lapply(word.count[undisputed], function(x){lapply(x, unlist)})
value <- lapply(value, function(x){lapply(x, sum)})
value <- lapply(value, unlist)
value <- lapply(value, sum)
value <- unlist(value)
boxplot(value ~ authors, horizontal=TRUE, xlab="# of words per essay")
n.sen <- lapply(sen.count[undisputed], unlist)
n.sen <- lapply(n.sen, sum)
n.sen <- unlist(n.sen)
boxplot(n.sen ~ authors, horizontal=TRUE, xlab="# of sentences per essay")
n.word <- lapply(word.count[undisputed], function(x){lapply(x, unlist)})
n.word <- lapply(n.word, function(x){lapply(x, sum)})
n.word <- lapply(n.word, unlist)
n.word <- lapply(n.word, sum)
n.word <- unlist(n.word)
boxplot(n.word ~ authors, horizontal=TRUE, xlab="# of words per essay")
cor(n.par, n.sen, n.word)
cor(cbind(n.par, n.sen, n.word))
n.par <- unlist(par.count[undisputed])
boxplot(n.par ~ authors, horizontal=TRUE, xlab="# of paragraphs per essay")
n.sen <- lapply(sen.count[undisputed], unlist)
n.sen <- lapply(n.sen, sum)
n.sen <- unlist(n.sen)
boxplot(n.sen ~ authors, horizontal=TRUE, xlab="# of sentences per essay")
n.word <- lapply(word.count[undisputed], function(x){lapply(x, unlist)})
n.word <- lapply(n.word, function(x){lapply(x, sum)})
n.word <- lapply(n.word, unlist)
n.word <- lapply(n.word, sum)
n.word <- unlist(n.word)
boxplot(n.word ~ authors, horizontal=TRUE, xlab="# of words per essay")
cor(cbind(n.par, n.sen, n.word))
# Obviously highly correlated
cor(cbind(n.par, n.sen, n.word))
round(cor(cbind(n.par, n.sen, n.word)), 3)
hamilton
hamilton
length(hamilton)
round(cor(cbind(n.par[1:51], n.sen[1:51], n.word[1:51])), 3)
round(cor(cbind(n.par[-c(1:51)], n.sen[-c(1:51)], n.word[-c(1:51)])), 3)
n.per.essay <- data.frame(n.par=n.par, n.sen=n.sen, n.word=n.word)
round(cor(n.per.essay), 3)
jay.index <- which(authors=="Jay")
hamilton.index <- which(authors=="Hamilton")
madison.index <- which(authors=="Madison")
jay.index <- which(authors=="Jay")
round(cor(n.per.essay[hamilton.index, ]), 3)
round(cor(n.per.essay[madison.index, ]), 3)
round(cor(n.per.essay[jay.index, ]), 3)
round(cor(n.per.essay[-hamilton.index, ]), 3)
round(cor(n.per.essay[hamilton.index, ]), 3)
table(authors)
boxplot(n.word ~ authors, horizontal=TRUE, xlab="# of words per essay")
n.sen <- lapply(sen.count[undisputed], unlist)
n.sen
n.sen <- lapply(sen.count, unlist)
h.sen
n.sen
sen.count
n.sen <- lapply(n.sen, sum)
n.sen <- unlist(n.sen)
n.sen
n.sen <- lapply(n.sen, sum)
n.sen
n.sen <- lapply(sen.count, unlist)
n.sen
n.word <- lapply(word.count[undisputed], function(x){lapply(x, unlist)})
n.word <- lapply(n.word, function(x){lapply(x, sum)})
n.word <- lapply(n.word, unlist)
n.word
n.sen <- lapply(sen.count, unlist)
n.sen <- lapply(sen.count, unlist)
n.sen <- lapply(n.sen, sum)
n.sen <- unlist(n.sen)
n.sen
n.sen <- lapply(sen.count, unlist)
n.sen
n.sen <- unlist(n.sen)
n.sen
n.sen <- lapply(sen.count, unlist)
n.sen
sen.count
n.word <- lapply(word.count[undisputed], function(x){lapply(x, unlist)})
n.word
sen.count
n.sen <- lapply(sen.count[undisputed], unlist)
n.sen
n.word <- lapply(word.count[undisputed], function(x){lapply(x, unlist)})
n.word <- lapply(n.word, function(x){lapply(x, sum)})
n.word
n.word <- lapply(n.word, unlist)
n.word
n.sen <- lapply(sen.count[undisputed], unlist)
words.per.sen <- n.sen
word.count
word.count[undisputed]
n.word <- lapply(word.count[undisputed], function(x){lapply(x, unlist)})
n.word
n.word
fed.papers[undisputed]
n.word
lapply(n.word, length)
n.word
lapply(n.word, function(x){lapply(x, length)})
n.sen <- lapply(n.word, function(x){lapply(x, length)})
n.sen
lapply(n.sen, sum)
lapply(n.sen, unlist)
n.sen <- lapply(n.sen, unlist)
n.sen
lapply(n.sen, sum)
lapply(n.sen, sum)
n.sen
n.sen <- lapply(n.sen, sum)
n.word <- lapply(word.count[undisputed], function(x){lapply(x, unlist)})
n.word
n.sen <- lapply(n.word, function(x){lapply(x, sum)})
n.word <- lapply(word.count[undisputed], function(x){lapply(x, unlist)})
n.word <- lapply(n.word, function(x){lapply(x, sum)})
n.word
n.word <- lapply(word.count[undisputed], function(x){lapply(x, unlist)})
n.word
n.word <- lapply(n.word, function(x){lapply(x, sum)})
n.word
n.word <- lapply(word.count[undisputed], function(x){lapply(x, unlist)})
n.word
n.sen <- lapply(n.word, function(x){lapply(x, length)})
n.word <- lapply(word.count[undisputed], function(x){lapply(x, unlist)})
n.sen <- lapply(n.word, function(x){lapply(x, length)})
n.word
n.sen
n.sen <- lapply(n.sen, unlist)
n.sen
n.word <- lapply(word.count[undisputed], function(x){lapply(x, unlist)})
n.word
n.word
n.sen
sen.count
n.word
sen.count[69]
n.word <- lapply(word.count[undisputed], function(x){lapply(x, unlist)})
n.word
undisputed
n.word
sen.count[undisputed]
n.word <- lapply(word.count[undisputed], function(x){lapply(x, unlist)})
n.sen <- sen.count[undisputed]
n.word
n.sen
n.word <- lapply(word.count[undisputed], function(x){lapply(x, unlist)})
n.word
unlist(n.word)
n.sen <- sen.count[undisputed]
n.sen
hist(n.word)
n.word <- lapply(word.count[undisputed], function(x){lapply(x, unlist)})
n.word
hist(unlist(n.word))
n.sen <- sen.count[undisputed]
n.sen
lapply(n.sen, unlist)
n.sen <- lapply(n.sen, unlist)
n.sen
authors
n.sen <- lapply(n.sen, sum)
n.sen
n.sen <- unlist(n.sen)
n.sen
rep(authors, c(3,4,5))
rep(authors, each=c(3,4,5))
authors
rep(unique(authors), each=c(3,4,5))
unique(authors)
rep(unique(authors), times=c(3,4,5))
n.sen
authors.sen <- rep(authors, n.sen)
authors.sen
n.word <- lapply(word.count[undisputed], function(x){lapply(x, unlist)})
n.word <- unlist(n.word)
boxplot(n.word ~ authors.sen, horizontal=TRUE, xlab="# of words per sentence")
library(ggplot2)
temp <- data.frame(n.word=n.word, author=author.sen)
temp <- data.frame(n.word=n.word, author=authors.sen)
temp
temp <- data.frame(n.word=n.word, author=authors.sen)
ggplot(temp, aes(x=as.factor(author), fill=as.factor(author))) +
geom_bar() + facet_grid (n.word ~ author) + xlab("Words")
ggplot(temp, aes(x=as.factor(author), fill=as.factor(author))) +
geom_bar() + facet_grid(n.word ~ author) + xlab("Words")
ggplot(temp, aes(x=as.factor(author))) +
geom_bar() + facet_grid(n.word ~ author) + xlab("Words")
library(ggplot2)
ggplot(temp, aes(x=as.factor(author))) +
geom_bar() + facet_grid(n.word ~ author) + xlab("Words")
ggplot(temp, aes(x=as.factor(author))) +
geom_bar() + xlab("Words")
ggplot(temp, aes(x=as.factor(author))) +
geom_bar() + xlab("Words") + facet_grid(n.word~author)
ggplot(temp, aes(x=as.factor(author))) + geom_histogram(binwidth = 0.5)
temp
ggplot(temp, aes(x=author)) + geom_histogram(binwidth = 0.5)
ggplot(temp, aes(y=n.word)) + geom_histogram(binwidth = 0.5)
ggplot(temp, aes(x=n.word)) + geom_histogram()
ggplot(temp, aes(x=n.word)) + geom_histogram() + facet_grid(author)
ggplot(temp, aes(x=n.word)) + geom_histogram() + facet_grid(n.word~author)
ggplot(temp, aes(x=n.word)) + geom_histogram()
ggplot(temp, aes(x=n.word, fill=authors)) + geom_histogram()
ggplot(temp, aes(x=n.word, fill=author)) + geom_histogram()
ggplot(temp, aes(x=n.word)) + geom_histogram() + facet_grid(author ~ .)
ggplot(temp, aes(x=n.word)) +  geom_density() + facet_grid(author ~ .)
ggplot(temp, aes(x=n.word)) + geom_histogram(aes(y=..density..)) + facet_grid(author ~ .)
ggplot(temp, aes(x=n.word)) +
geom_histogram(aes(y=..density..), binwidth=.5) +
facet_grid(author ~ .)
ggplot(temp, aes(x=n.word)) +
geom_histogram(aes(y=..density..), binwidth=5) +
facet_grid(author ~ .)
ggplot(temp, aes(x=n.word, fill=author)) +
geom_histogram(binwidth=5, alpha=.5, position="identity")
ggplot(temp, aes(x=n.word, fill=author)) +
geom_histogram(aes(y=..density..), binwidth=5, alpha=.5, position="identity")
temp <- data.frame(n.word=n.word[-authors.sen=="Jay"],
author=authors.sen[-authors.sen=="Jay"])
temp <- data.frame(n.word=n.word[-which(authors.sen=="Jay")],
author=authors.sen[-which(authors.sen=="Jay")])
temp
ggplot(temp, aes(x=n.word, fill=author)) +
geom_histogram(aes(y=..density..), binwidth=5, alpha=.5, position="identity")
library(ggplot2)
boxplot(n.word ~ authors.sen, horizontal=TRUE, xlab="# of words per sentence")
temp <- data.frame(n.word=n.word, author=authors.sen)
ggplot(temp, aes(x=n.word)) +
geom_histogram(aes(y=..density..), binwidth=5) +
facet_grid(author ~ .)
tapply(temp$n.word, temp$author, summary)
tapply(temp$n.word, temp$author, sd)
ggplot(temp, aes(x=n.word)) +
geom_histogram(aes(y=..density..), binwidth=5) +
facet_grid(author ~ .)
ggplot(temp, aes(x=n.word, fill=author)) +
geom_histogram(aes(y=..density..), binwidth=5, alpha=.5, position="identity")
tapply(temp$n.word, temp$author, summary)
unlist(sen.count)
sum(unlist(sen.count))
sum(temp$n.word)
sen.count
length(temp$n.word)
sum(unlist(sen.count[undisputed]))
authors
authors.sen
n.word
n.word <- lapply(word.count[undisputed], function(x){lapply(x, unlist)})
n.word
n.char <- lapply(char.count[undisputed], function(x){lapply(x, unlist)})
n.char
n.char[[69]]
n.word <- lapply(word.count[undisputed], function(x){lapply(x, unlist)})
n.word <- unlist(n.word)
yo <- n.word
yo1<-unlist(unlist(word.count[undisputed]))
length(yo1)
length(yo)
n.word <- unlist(word.count[undisputed])
n.word <- unlist(n.word)
length(n.word)
n.char <- unlist(unlist(unlist(char.count)))
length(n.char)
n.word <- word.count[undisputed]
n.word
n.word <- lapply(n.word, unlist)
n.word <- lapply(n.word, sum)
n.word
n.sen <- unlist(n.sen)
# intact
n.word <- unlist(word.count[undisputed])
n.word <- unlist(n.word)
n.sen <- sen.count[undisputed]
n.sen <- lapply(n.sen, unlist)
n.sen <- lapply(n.sen, sum)
n.sen <- unlist(n.sen)
authors.sen <- rep(authors, times=n.sen)
n.char <- unlist(unlist(unlist(char.count)))
n.word <- word.count[undisputed]
n.word <- lapply(n.word, unlist)
n.word <- lapply(n.word, sum)
n.word <- unlist(n.word)
n.word
sum(n.word)
n.char[1:10]
sum(n.char)
n.char <- unlist(unlist(unlist(char.count)))
n.char[1:10]
n.char <- unlist(unlist(unlist(char.count[undisputed])))
length(n.char)
sum(n.char)
n.word <- word.count[undisputed]
n.word <- lapply(n.word, unlist)
n.word <- lapply(n.word, sum)
n.word <- unlist(n.word)
sum(n.word)
n.word <- word.count[undisputed]
n.word
n.word <- lapply(n.word, unlist)
n.word
sum(n.char)
length(n.char)
word.count
n.word <- word.count[undisputed]
n.word
unlist(n.word)
sum(unlist(n.word))
n.char <- unlist(unlist(unlist(char.count[undisputed])))
length(n.char)
char.count[[69]]
char.count[[85]]
word.count
unlist(word.count)
par.count <- sen.count <- word.count <- char.count <-
vector(length=n.essays, mode="list")
for (i in 1:n.essays) {
essay <- fed.papers[[i]]
n.par <- length(essay)
par.count[[i]] <- n.par
# Further nested lists
sen.count[[i]] <- word.count[[i]] <- char.count[[i]] <-
vector(length=n.par, mode="list")
for (j in 1:n.par) {
par <- essay[[j]]
sentences <- sentDetect(par, language="en")
n.sen <- length(sentences)
sen.count[[i]][[j]] <- n.sen
# Further nested lists
word.count[[i]][[j]] <- char.count[[i]][[j]] <-
vector(length=n.sen, mode="list")
for (k in 1:n.sen) {
sen <- sentences[[k]]
sen <- tolower(sen)
sen <- gsub("[[:punct:]]", "", sen)
words <- unlist(strsplit(sen, " "))
n.words <- length(words)
word.count[[i]][[j]][[k]] <- n.words
# Further nested lists
char.count[[i]][[j]][[k]] <-
vector(length=n.words, mode="list")
for (l in 1:n.words){
char.count[[i]][[j]][[k]][[l]] <- nchar(words[l])
}
}
}
}
n.char <- unlist(unlist(unlist(char.count[undisputed])))
sum(n.char)
n.word <- word.count[undisputed]
n.word <- unlist(unlist(n.word))
n.word
sum(n.char)
sum(n.word)
word.count
#
# Per word metrics:  average char per word
#
n.char <- unlist(unlist(unlist(char.count[undisputed])))
n.word <- word.count[undisputed]
n.word <- unlist(unlist(n.word))
sum(n.char)
length(n.char)
sum(n.word)
boxplot(n.char ~ authors.word, horizontal=TRUE, xlab="# of characters per word")
n.char <- unlist(unlist(unlist(char.count[undisputed])))
n.word <- word.count[undisputed]
n.word <- unlist(unlist(n.word))
authors.word <- rep(authors, times=n.word)
boxplot(n.char ~ authors.word, horizontal=TRUE, xlab="# of characters per word")
n.word
authors.word <- rep(authors, each=n.word)
n.word
n.word <- unlist(word.count[undisputed])
n.word <- unlist(n.word)
n.sen <- sen.count[undisputed]
n.sen <- lapply(n.sen, unlist)
n.sen <- lapply(n.sen, sum)
n.sen <- unlist(n.sen)
authors.sen <- rep(authors, times=n.sen)
n.sen
n.word <- word.count[undisputed]
n.word <- unlist(n.word)
n.word
authors.word <- rep(authors, times=length(word.count))
authors.word
length(word.count)
authors
n.par
par.count
authors.word <- rep(authors, each=unlist(par.count))
authors.word <- rep(authors, times=unlist(par.count))
unlist(par.count)
authors.word <- rep(authors, times=unlist(par.count[undisputed]))
authors.word
authors.word
n.word
n.word <- word.count[undisputed]
word.count
length(n.char)
sum(n.word)
n.word <- word.count[undisputed]
n.word <- unlist(n.word)
sum(n.word)
length(authors.word)
authors.sen
authors.word <- rep("", sum(n.word))
authors
authors.word <- rep("", sum(n.word))
counter <- 1
for(i in 1:length(par.count))
for(j in 1:length(sen.count))
for(j in 1:length(word.count)){
authors.word[counter] <- authors[i]
counter <- counter + 1
}
word.count
lapply(word.count, unlist)
lapply(lapply(word.count, unlist), sum)
unlist(lapply(lapply(word.count, unlist), sum))
unlist(lapply(lapply(word.count[undisputed], unlist), sum))
authors.word <- rep(author, times=unlist(lapply(lapply(word.count[undisputed], unlist), sum))
authors.word <-
rep(author,
times=unlist(lapply(lapply(word.count[undisputed], unlist), sum))
)
authors.word <-
rep(authors,
times=unlist(lapply(lapply(word.count[undisputed], unlist), sum))
)
length(authors.word)
length(n.char)
boxplot(n.char ~ authors.word, horizontal=TRUE, xlab="# of characters per word")
temp <- data.frame(n.char=n.char, author=authors.word)
ggplot(temp, aes(x=n.char)) +  geom_histogram(aes(y=..density..), binwidth=5) +
facet_grid(author ~ .)
ggplot(temp, aes(x=n.char, fill=author)) +
geom_histogram(aes(y=..density..), binwidth=5, alpha=.5, position="identity")
boxplot(n.char ~ authors.word, horizontal=TRUE, xlab="# of characters per word")
